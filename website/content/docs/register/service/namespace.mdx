---
layout: docs
page_title: Register services into a specific namespace
description: >-
  Learn how to register a service a particular namespace so that you can use Consul DNS to address it securely.
---

# Register services into a specific namespace

This topic describes the process to register a service into a particular namespace.

## Overview

Namespaces allow multiple teams within the same organization to share the same
Consul datacenter(s) by separating services, Consul KV data, and other Consul
data per team. This provides operators with the ability to more easily provide
Consul as a service. Namespaces also enable operators to [delegate ACL
management](/consul/tutorials/namespaces/namespaces-secure-shared-access).

Any service that is not registered to a namespace is added to the `default`
namespace. All services are added to namespaces in Consul version 1.7 and
later.

## Register services in namespaces

You register services in a namespace by adding namespace information to the registration. This should not disrupt your existing workflow. The namespace information can be added to the registration using one of the
following methods.

- add the `namespace` option to the service registration file.
- use the `-namespace` flag with the API or CLI at registration time.

If you would like to migrate an existing service into a new namespace,
re-register the service with the new namespace information.

## Default namespace service registration

To register a service in the `default` namespace, use your existing registration
workflow; you do not need to add namespace information as long as a namespace 
ACL token isn't provided. In the example below, you will register the `mysql` 
service in the default namespace.

First, create a service registration file for the MySQL service.

<CodeBlockConfig filename="mysql.hcl">

```hcl
service {
  name = "mysql"
  port = 9003
  connect {
    sidecar_service {}
  }
}
```

</CodeBlockConfig>

Next, register the service using the Consul CLI.

```shell-session
$ consul services register mysql.hcl
```

## App-team namespace service registration

To register a service in a user-defined namespace, include the namespace in the
registration file or pass it with a flag at registration time. In this tutorial,
we will include the namespace in the file.

First, create the service registration file named `wordpress.hcl`. Paste in the
following registration, which includes the service name, port, and namespace.

<CodeBlockConfig filename="wordpress.hcl">

```hcl
service {
  name = "wordpress"
  port = 9003
  namespace = "app-team"
  connect {
    sidecar_service {
      proxy {
        upstreams = [
          {
            destination_name = "counting"
            local_bind_port  = 5000
         }
        ]
      }
    }
  }
}
```

</CodeBlockConfig>

Next register the service.

```shell-session
$ consul services register wordpress.hcl
```

## Consul DNS with registered services

The default DNS query behavior allows you to query by datacenter,
`<service-name>.service.<datacenter>.consul`, or datacenter and namespace,
`<service-name>.service.<namespace>.<datacenter>.consul`. 

To use only the `namespace` parameter in the DNS query, you must
set the `prefer_namespace` option to `true` in the [agent's configuration](/consul/docs/agent/config/config-files#dns_prefer_namespace).
With the option set to true, the new query structure will be, `<service-name>.service.<namespace>.consul`. This will disable
the ability to query by datacenter only. However, with the option set to true
you can still use both namespace and
datacenter to the query.